"use strict";

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
;

(function (factory) {
  var registeredInModuleLoader;

  if (typeof define === 'function' && define.amd) {
    define(factory);
    registeredInModuleLoader = true;
  }

  if ((typeof exports === "undefined" ? "undefined" : _typeof(exports)) === 'object') {
    module.exports = factory();
    registeredInModuleLoader = true;
  }

  if (!registeredInModuleLoader) {
    var OldCookies = window.Cookies;
    var api = window.Cookies = factory();

    api.noConflict = function () {
      window.Cookies = OldCookies;
      return api;
    };
  }
})(function () {
  function extend() {
    var i = 0;
    var result = {};

    for (; i < arguments.length; i++) {
      var attributes = arguments[i];

      for (var key in attributes) {
        result[key] = attributes[key];
      }
    }

    return result;
  }

  function decode(s) {
    return s.replace(/(%[0-9A-Z]{2})+/g, decodeURIComponent);
  }

  function init(converter) {
    function api() {}

    function set(key, value, attributes) {
      if (typeof document === 'undefined') {
        return;
      }

      attributes = extend({
        path: '/'
      }, api.defaults, attributes);

      if (typeof attributes.expires === 'number') {
        attributes.expires = new Date(new Date() * 1 + attributes.expires * 864e+5);
      } // We're using "expires" because "max-age" is not supported by IE


      attributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';

      try {
        var result = JSON.stringify(value);

        if (/^[\{\[]/.test(result)) {
          value = result;
        }
      } catch (e) {}

      value = converter.write ? converter.write(value, key) : encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);
      key = encodeURIComponent(String(key)).replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent).replace(/[\(\)]/g, escape);
      var stringifiedAttributes = '';

      for (var attributeName in attributes) {
        if (!attributes[attributeName]) {
          continue;
        }

        stringifiedAttributes += '; ' + attributeName;

        if (attributes[attributeName] === true) {
          continue;
        } // Considers RFC 6265 section 5.2:
        // ...
        // 3.  If the remaining unparsed-attributes contains a %x3B (";")
        //     character:
        // Consume the characters of the unparsed-attributes up to,
        // not including, the first %x3B (";") character.
        // ...


        stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];
      }

      return document.cookie = key + '=' + value + stringifiedAttributes;
    }

    function get(key, json) {
      if (typeof document === 'undefined') {
        return;
      }

      var jar = {}; // To prevent the for loop in the first place assign an empty array
      // in case there are no cookies at all.

      var cookies = document.cookie ? document.cookie.split('; ') : [];
      var i = 0;

      for (; i < cookies.length; i++) {
        var parts = cookies[i].split('=');
        var cookie = parts.slice(1).join('=');

        if (!json && cookie.charAt(0) === '"') {
          cookie = cookie.slice(1, -1);
        }

        try {
          var name = decode(parts[0]);
          cookie = (converter.read || converter)(cookie, name) || decode(cookie);

          if (json) {
            try {
              cookie = JSON.parse(cookie);
            } catch (e) {}
          }

          jar[name] = cookie;

          if (key === name) {
            break;
          }
        } catch (e) {}
      }

      return key ? jar[key] : jar;
    }

    api.set = set;

    api.get = function (key) {
      return get(key, false
      /* read as raw */
      );
    };

    api.getJSON = function (key) {
      return get(key, true
      /* read as json */
      );
    };

    api.remove = function (key, attributes) {
      set(key, '', extend(attributes, {
        expires: -1
      }));
    };

    api.defaults = {};
    api.withConverter = init;
    return api;
  }

  return init(function () {});
});
"use strict";

var previously_viewed_urls = Cookies.getJSON('viewed_urls');
var viewed_urls = [];
var current_url = window.location.pathname;

if ('undefined' !== typeof previously_viewed_urls) {
  viewed_urls = previously_viewed_urls;
}

if (viewed_urls.indexOf(current_url) == -1) {
  viewed_urls.push(window.location.pathname);
}

if ('undefined' !== typeof wp_user_viewed_items_settings) {
  if ('undefined' !== typeof wp_user_viewed_items_settings.cookie_domain) {
    var cookie_args = {
      domain: wp_user_viewed_items_settings.cookie_domain
    };

    if ('undefined' !== typeof wp_user_viewed_items_settings.cookie_secure) {
      cookie_args.secure = wp_user_viewed_items_settings.cookie_secure;
    } else {
      cookie_args.secure = false;
    }

    if ('undefined' !== typeof wp_user_viewed_items_settings.cookie_expires) {
      cookie_args.expires = parseInt(wp_user_viewed_items_settings.cookie_expires, 10);
    } else {
      cookie_args.expires = 30;
    }

    Cookies.set('viewed_urls', viewed_urls, cookie_args);
  }

  if ('undefined' !== typeof wp_user_viewed_items_settings.items_read_number) {
    var items_read_number = wp_user_viewed_items_settings.items_read_number;
  }

  if ('undefined' !== typeof wp_user_viewed_items_settings.action_to_perform) {
    var action_to_perform = wp_user_viewed_items_settings.action_to_perform;
  }

  if ('undefined' !== typeof wp_user_viewed_items_settings.popup_to_load) {
    var popup_to_load = wp_user_viewed_items_settings.popup_to_load;
  }

  if (items_read_number < viewed_urls.length && 'popup' === action_to_perform && 'undefined' !== typeof popup_to_load) {
    jQuery(document).on('pumInit', '#popmake-' + popup_to_load, function () {
      // we would have to save this popup id as a plugin setting
      PUM.open(popup_to_load); // we would have to save this popup id as a plugin setting
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlbmRvci9qcy5jb29raWUuanMiLCJzcmMvdmlzaXRlZC5qcyJdLCJuYW1lcyI6WyJmYWN0b3J5IiwicmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyIiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIk9sZENvb2tpZXMiLCJ3aW5kb3ciLCJDb29raWVzIiwiYXBpIiwibm9Db25mbGljdCIsImV4dGVuZCIsImkiLCJyZXN1bHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJhdHRyaWJ1dGVzIiwia2V5IiwiZGVjb2RlIiwicyIsInJlcGxhY2UiLCJkZWNvZGVVUklDb21wb25lbnQiLCJpbml0IiwiY29udmVydGVyIiwic2V0IiwidmFsdWUiLCJkb2N1bWVudCIsInBhdGgiLCJkZWZhdWx0cyIsImV4cGlyZXMiLCJEYXRlIiwidG9VVENTdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwidGVzdCIsImUiLCJ3cml0ZSIsImVuY29kZVVSSUNvbXBvbmVudCIsIlN0cmluZyIsImVzY2FwZSIsInN0cmluZ2lmaWVkQXR0cmlidXRlcyIsImF0dHJpYnV0ZU5hbWUiLCJzcGxpdCIsImNvb2tpZSIsImdldCIsImpzb24iLCJqYXIiLCJjb29raWVzIiwicGFydHMiLCJzbGljZSIsImpvaW4iLCJjaGFyQXQiLCJuYW1lIiwicmVhZCIsInBhcnNlIiwiZ2V0SlNPTiIsInJlbW92ZSIsIndpdGhDb252ZXJ0ZXIiLCJwcmV2aW91c2x5X3ZpZXdlZF91cmxzIiwidmlld2VkX3VybHMiLCJjdXJyZW50X3VybCIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJpbmRleE9mIiwicHVzaCIsIndwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzIiwiY29va2llX2RvbWFpbiIsImNvb2tpZV9hcmdzIiwiZG9tYWluIiwiY29va2llX3NlY3VyZSIsInNlY3VyZSIsImNvb2tpZV9leHBpcmVzIiwicGFyc2VJbnQiLCJpdGVtc19yZWFkX251bWJlciIsImFjdGlvbl90b19wZXJmb3Jt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Q0FBQ1EsaUJBQXREO0FBQ0E7O0FBQ0QsTUFBSyxnQkFBZ0IsT0FBT1IsNkJBQTZCLENBQUNTLGlCQUExRCxFQUE4RTtBQUM3RSxRQUFJQSxpQkFBaUIsR0FBR1QsNkJBQTZCLENBQUNTLGlCQUF0RDtBQUNBOztBQUNELE1BQUssZ0JBQWdCLE9BQU9ULDZCQUE2QixDQUFDVSxhQUExRCxFQUEwRTtBQUN6RSxRQUFJQSxhQUFhLEdBQUdWLDZCQUE2QixDQUFDVSxhQUFsRDtBQUNBOztBQUNELE1BQUtGLGlCQUFpQixHQUFHZCxXQUFXLENBQUM1QyxNQUFoQyxJQUEwQyxZQUFZMkQsaUJBQXRELElBQTJFLGdCQUFnQixPQUFPQyxhQUF2RyxFQUF1SDtBQUN0SEMsSUFBQUEsTUFBTSxDQUFFbEQsUUFBRixDQUFOLENBQW1CbUQsRUFBbkIsQ0FBdUIsU0FBdkIsRUFBa0MsY0FBY0YsYUFBaEQsRUFBK0QsWUFBWTtBQUFFO0FBQ3pFRyxNQUFBQSxHQUFHLENBQUNDLElBQUosQ0FBVUosYUFBVixFQUR1RSxDQUM1QztBQUM5QixLQUZEO0FBR0E7QUFDRCIsImZpbGUiOiJ3cC11c2VyLXZpZXdlZC1pdGVtcy1mcm9udC1lbmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEphdmFTY3JpcHQgQ29va2llIHYyLjIuMVxuICogaHR0cHM6Ly9naXRodWIuY29tL2pzLWNvb2tpZS9qcy1jb29raWVcbiAqXG4gKiBDb3B5cmlnaHQgMjAwNiwgMjAxNSBLbGF1cyBIYXJ0bCAmIEZhZ25lciBCcmFja1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKi9cbjsoZnVuY3Rpb24gKGZhY3RvcnkpIHtcblx0dmFyIHJlZ2lzdGVyZWRJbk1vZHVsZUxvYWRlcjtcblx0aWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuXHRcdGRlZmluZShmYWN0b3J5KTtcblx0XHRyZWdpc3RlcmVkSW5Nb2R1bGVMb2FkZXIgPSB0cnVlO1xuXHR9XG5cdGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0XHRyZWdpc3RlcmVkSW5Nb2R1bGVMb2FkZXIgPSB0cnVlO1xuXHR9XG5cdGlmICghcmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyKSB7XG5cdFx0dmFyIE9sZENvb2tpZXMgPSB3aW5kb3cuQ29va2llcztcblx0XHR2YXIgYXBpID0gd2luZG93LkNvb2tpZXMgPSBmYWN0b3J5KCk7XG5cdFx0YXBpLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR3aW5kb3cuQ29va2llcyA9IE9sZENvb2tpZXM7XG5cdFx0XHRyZXR1cm4gYXBpO1xuXHRcdH07XG5cdH1cbn0oZnVuY3Rpb24gKCkge1xuXHRmdW5jdGlvbiBleHRlbmQgKCkge1xuXHRcdHZhciBpID0gMDtcblx0XHR2YXIgcmVzdWx0ID0ge307XG5cdFx0Zm9yICg7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBhdHRyaWJ1dGVzID0gYXJndW1lbnRzWyBpIF07XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuXHRcdFx0XHRyZXN1bHRba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fVxuXG5cdGZ1bmN0aW9uIGRlY29kZSAocykge1xuXHRcdHJldHVybiBzLnJlcGxhY2UoLyglWzAtOUEtWl17Mn0pKy9nLCBkZWNvZGVVUklDb21wb25lbnQpO1xuXHR9XG5cblx0ZnVuY3Rpb24gaW5pdCAoY29udmVydGVyKSB7XG5cdFx0ZnVuY3Rpb24gYXBpKCkge31cblxuXHRcdGZ1bmN0aW9uIHNldCAoa2V5LCB2YWx1ZSwgYXR0cmlidXRlcykge1xuXHRcdFx0aWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRhdHRyaWJ1dGVzID0gZXh0ZW5kKHtcblx0XHRcdFx0cGF0aDogJy8nXG5cdFx0XHR9LCBhcGkuZGVmYXVsdHMsIGF0dHJpYnV0ZXMpO1xuXG5cdFx0XHRpZiAodHlwZW9mIGF0dHJpYnV0ZXMuZXhwaXJlcyA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0YXR0cmlidXRlcy5leHBpcmVzID0gbmV3IERhdGUobmV3IERhdGUoKSAqIDEgKyBhdHRyaWJ1dGVzLmV4cGlyZXMgKiA4NjRlKzUpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBXZSdyZSB1c2luZyBcImV4cGlyZXNcIiBiZWNhdXNlIFwibWF4LWFnZVwiIGlzIG5vdCBzdXBwb3J0ZWQgYnkgSUVcblx0XHRcdGF0dHJpYnV0ZXMuZXhwaXJlcyA9IGF0dHJpYnV0ZXMuZXhwaXJlcyA/IGF0dHJpYnV0ZXMuZXhwaXJlcy50b1VUQ1N0cmluZygpIDogJyc7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdHZhciByZXN1bHQgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG5cdFx0XHRcdGlmICgvXltcXHtcXFtdLy50ZXN0KHJlc3VsdCkpIHtcblx0XHRcdFx0XHR2YWx1ZSA9IHJlc3VsdDtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZSkge31cblxuXHRcdFx0dmFsdWUgPSBjb252ZXJ0ZXIud3JpdGUgP1xuXHRcdFx0XHRjb252ZXJ0ZXIud3JpdGUodmFsdWUsIGtleSkgOlxuXHRcdFx0XHRlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKHZhbHVlKSlcblx0XHRcdFx0XHQucmVwbGFjZSgvJSgyM3wyNHwyNnwyQnwzQXwzQ3wzRXwzRHwyRnwzRnw0MHw1Qnw1RHw1RXw2MHw3Qnw3RHw3QykvZywgZGVjb2RlVVJJQ29tcG9uZW50KTtcblxuXHRcdFx0a2V5ID0gZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhrZXkpKVxuXHRcdFx0XHQucmVwbGFjZSgvJSgyM3wyNHwyNnwyQnw1RXw2MHw3QykvZywgZGVjb2RlVVJJQ29tcG9uZW50KVxuXHRcdFx0XHQucmVwbGFjZSgvW1xcKFxcKV0vZywgZXNjYXBlKTtcblxuXHRcdFx0dmFyIHN0cmluZ2lmaWVkQXR0cmlidXRlcyA9ICcnO1xuXHRcdFx0Zm9yICh2YXIgYXR0cmlidXRlTmFtZSBpbiBhdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdGlmICghYXR0cmlidXRlc1thdHRyaWJ1dGVOYW1lXSkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHN0cmluZ2lmaWVkQXR0cmlidXRlcyArPSAnOyAnICsgYXR0cmlidXRlTmFtZTtcblx0XHRcdFx0aWYgKGF0dHJpYnV0ZXNbYXR0cmlidXRlTmFtZV0gPT09IHRydWUpIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENvbnNpZGVycyBSRkMgNjI2NSBzZWN0aW9uIDUuMjpcblx0XHRcdFx0Ly8gLi4uXG5cdFx0XHRcdC8vIDMuICBJZiB0aGUgcmVtYWluaW5nIHVucGFyc2VkLWF0dHJpYnV0ZXMgY29udGFpbnMgYSAleDNCIChcIjtcIilcblx0XHRcdFx0Ly8gICAgIGNoYXJhY3Rlcjpcblx0XHRcdFx0Ly8gQ29uc3VtZSB0aGUgY2hhcmFjdGVycyBvZiB0aGUgdW5wYXJzZWQtYXR0cmlidXRlcyB1cCB0byxcblx0XHRcdFx0Ly8gbm90IGluY2x1ZGluZywgdGhlIGZpcnN0ICV4M0IgKFwiO1wiKSBjaGFyYWN0ZXIuXG5cdFx0XHRcdC8vIC4uLlxuXHRcdFx0XHRzdHJpbmdpZmllZEF0dHJpYnV0ZXMgKz0gJz0nICsgYXR0cmlidXRlc1thdHRyaWJ1dGVOYW1lXS5zcGxpdCgnOycpWzBdO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gKGRvY3VtZW50LmNvb2tpZSA9IGtleSArICc9JyArIHZhbHVlICsgc3RyaW5naWZpZWRBdHRyaWJ1dGVzKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBnZXQgKGtleSwganNvbikge1xuXHRcdFx0aWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgamFyID0ge307XG5cdFx0XHQvLyBUbyBwcmV2ZW50IHRoZSBmb3IgbG9vcCBpbiB0aGUgZmlyc3QgcGxhY2UgYXNzaWduIGFuIGVtcHR5IGFycmF5XG5cdFx0XHQvLyBpbiBjYXNlIHRoZXJlIGFyZSBubyBjb29raWVzIGF0IGFsbC5cblx0XHRcdHZhciBjb29raWVzID0gZG9jdW1lbnQuY29va2llID8gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7ICcpIDogW107XG5cdFx0XHR2YXIgaSA9IDA7XG5cblx0XHRcdGZvciAoOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgcGFydHMgPSBjb29raWVzW2ldLnNwbGl0KCc9Jyk7XG5cdFx0XHRcdHZhciBjb29raWUgPSBwYXJ0cy5zbGljZSgxKS5qb2luKCc9Jyk7XG5cblx0XHRcdFx0aWYgKCFqc29uICYmIGNvb2tpZS5jaGFyQXQoMCkgPT09ICdcIicpIHtcblx0XHRcdFx0XHRjb29raWUgPSBjb29raWUuc2xpY2UoMSwgLTEpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHR2YXIgbmFtZSA9IGRlY29kZShwYXJ0c1swXSk7XG5cdFx0XHRcdFx0Y29va2llID0gKGNvbnZlcnRlci5yZWFkIHx8IGNvbnZlcnRlcikoY29va2llLCBuYW1lKSB8fFxuXHRcdFx0XHRcdFx0ZGVjb2RlKGNvb2tpZSk7XG5cblx0XHRcdFx0XHRpZiAoanNvbikge1xuXHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0Y29va2llID0gSlNPTi5wYXJzZShjb29raWUpO1xuXHRcdFx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRqYXJbbmFtZV0gPSBjb29raWU7XG5cblx0XHRcdFx0XHRpZiAoa2V5ID09PSBuYW1lKSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBrZXkgPyBqYXJba2V5XSA6IGphcjtcblx0XHR9XG5cblx0XHRhcGkuc2V0ID0gc2V0O1xuXHRcdGFwaS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XG5cdFx0XHRyZXR1cm4gZ2V0KGtleSwgZmFsc2UgLyogcmVhZCBhcyByYXcgKi8pO1xuXHRcdH07XG5cdFx0YXBpLmdldEpTT04gPSBmdW5jdGlvbiAoa2V5KSB7XG5cdFx0XHRyZXR1cm4gZ2V0KGtleSwgdHJ1ZSAvKiByZWFkIGFzIGpzb24gKi8pO1xuXHRcdH07XG5cdFx0YXBpLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXksIGF0dHJpYnV0ZXMpIHtcblx0XHRcdHNldChrZXksICcnLCBleHRlbmQoYXR0cmlidXRlcywge1xuXHRcdFx0XHRleHBpcmVzOiAtMVxuXHRcdFx0fSkpO1xuXHRcdH07XG5cblx0XHRhcGkuZGVmYXVsdHMgPSB7fTtcblxuXHRcdGFwaS53aXRoQ29udmVydGVyID0gaW5pdDtcblxuXHRcdHJldHVybiBhcGk7XG5cdH1cblxuXHRyZXR1cm4gaW5pdChmdW5jdGlvbiAoKSB7fSk7XG59KSk7XG4iLCJ2YXIgcHJldmlvdXNseV92aWV3ZWRfdXJscyA9IENvb2tpZXMuZ2V0SlNPTiggJ3ZpZXdlZF91cmxzJyApO1xudmFyIHZpZXdlZF91cmxzID0gW107XG52YXIgY3VycmVudF91cmwgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG5pZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2YgcHJldmlvdXNseV92aWV3ZWRfdXJscyApIHtcblx0dmlld2VkX3VybHMgPSBwcmV2aW91c2x5X3ZpZXdlZF91cmxzO1xufVxuaWYgKCB2aWV3ZWRfdXJscy5pbmRleE9mKCBjdXJyZW50X3VybCApID09IC0xICkge1xuXHR2aWV3ZWRfdXJscy5wdXNoKCB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgKTtcbn1cbmlmICggJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncyApIHtcblx0aWYgKCAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzLmNvb2tpZV9kb21haW4gKSB7XG5cdFx0dmFyIGNvb2tpZV9hcmdzID0ge1xuXHRcdFx0ZG9tYWluOiB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncy5jb29raWVfZG9tYWluXG5cdFx0fTtcblx0XHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuY29va2llX3NlY3VyZSApIHtcblx0XHRcdGNvb2tpZV9hcmdzLnNlY3VyZSA9IHdwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzLmNvb2tpZV9zZWN1cmU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvb2tpZV9hcmdzLnNlY3VyZSA9IGZhbHNlO1xuXHRcdH1cblx0XHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuY29va2llX2V4cGlyZXMgKSB7XG5cdFx0XHRjb29raWVfYXJncy5leHBpcmVzID0gcGFyc2VJbnQoIHdwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzLmNvb2tpZV9leHBpcmVzLCAxMCApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb29raWVfYXJncy5leHBpcmVzID0gMzA7XG5cdFx0fVxuXHRcdENvb2tpZXMuc2V0KFxuXHRcdFx0J3ZpZXdlZF91cmxzJyxcblx0XHRcdHZpZXdlZF91cmxzLFxuXHRcdFx0Y29va2llX2FyZ3Ncblx0XHQpO1xuXHR9XG5cdGlmICggJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncy5pdGVtc19yZWFkX251bWJlciApIHtcblx0XHR2YXIgaXRlbXNfcmVhZF9udW1iZXIgPSB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncy5pdGVtc19yZWFkX251bWJlcjtcblx0fVxuXHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuYWN0aW9uX3RvX3BlcmZvcm0gKSB7XG5cdFx0dmFyIGFjdGlvbl90b19wZXJmb3JtID0gd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuYWN0aW9uX3RvX3BlcmZvcm07XG5cdH1cblx0aWYgKCAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzLnBvcHVwX3RvX2xvYWQgKSB7XG5cdFx0dmFyIHBvcHVwX3RvX2xvYWQgPSB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncy5wb3B1cF90b19sb2FkO1xuXHR9XG5cdGlmICggaXRlbXNfcmVhZF9udW1iZXIgPCB2aWV3ZWRfdXJscy5sZW5ndGggJiYgJ3BvcHVwJyA9PT0gYWN0aW9uX3RvX3BlcmZvcm0gJiYgJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiBwb3B1cF90b19sb2FkICkge1xuXHRcdGpRdWVyeSggZG9jdW1lbnQgKS5vbiggJ3B1bUluaXQnLCAnI3BvcG1ha2UtJyArIHBvcHVwX3RvX2xvYWQsIGZ1bmN0aW9uICgpIHsgLy8gd2Ugd291bGQgaGF2ZSB0byBzYXZlIHRoaXMgcG9wdXAgaWQgYXMgYSBwbHVnaW4gc2V0dGluZ1xuXHRcdCAgICBQVU0ub3BlbiggcG9wdXBfdG9fbG9hZCApOyAvLyB3ZSB3b3VsZCBoYXZlIHRvIHNhdmUgdGhpcyBwb3B1cCBpZCBhcyBhIHBsdWdpbiBzZXR0aW5nXG5cdFx0fSk7XG5cdH1cbn0iXX0=
