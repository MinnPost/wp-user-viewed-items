"use strict";

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
;

(function (factory) {
  var registeredInModuleLoader;

  if (typeof define === 'function' && define.amd) {
    define(factory);
    registeredInModuleLoader = true;
  }

  if ((typeof exports === "undefined" ? "undefined" : _typeof(exports)) === 'object') {
    module.exports = factory();
    registeredInModuleLoader = true;
  }

  if (!registeredInModuleLoader) {
    var OldCookies = window.Cookies;
    var api = window.Cookies = factory();

    api.noConflict = function () {
      window.Cookies = OldCookies;
      return api;
    };
  }
})(function () {
  function extend() {
    var i = 0;
    var result = {};

    for (; i < arguments.length; i++) {
      var attributes = arguments[i];

      for (var key in attributes) {
        result[key] = attributes[key];
      }
    }

    return result;
  }

  function decode(s) {
    return s.replace(/(%[0-9A-Z]{2})+/g, decodeURIComponent);
  }

  function init(converter) {
    function api() {}

    function set(key, value, attributes) {
      if (typeof document === 'undefined') {
        return;
      }

      attributes = extend({
        path: '/'
      }, api.defaults, attributes);

      if (typeof attributes.expires === 'number') {
        attributes.expires = new Date(new Date() * 1 + attributes.expires * 864e+5);
      } // We're using "expires" because "max-age" is not supported by IE


      attributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';

      try {
        var result = JSON.stringify(value);

        if (/^[\{\[]/.test(result)) {
          value = result;
        }
      } catch (e) {}

      value = converter.write ? converter.write(value, key) : encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);
      key = encodeURIComponent(String(key)).replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent).replace(/[\(\)]/g, escape);
      var stringifiedAttributes = '';

      for (var attributeName in attributes) {
        if (!attributes[attributeName]) {
          continue;
        }

        stringifiedAttributes += '; ' + attributeName;

        if (attributes[attributeName] === true) {
          continue;
        } // Considers RFC 6265 section 5.2:
        // ...
        // 3.  If the remaining unparsed-attributes contains a %x3B (";")
        //     character:
        // Consume the characters of the unparsed-attributes up to,
        // not including, the first %x3B (";") character.
        // ...


        stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];
      }

      return document.cookie = key + '=' + value + stringifiedAttributes;
    }

    function get(key, json) {
      if (typeof document === 'undefined') {
        return;
      }

      var jar = {}; // To prevent the for loop in the first place assign an empty array
      // in case there are no cookies at all.

      var cookies = document.cookie ? document.cookie.split('; ') : [];
      var i = 0;

      for (; i < cookies.length; i++) {
        var parts = cookies[i].split('=');
        var cookie = parts.slice(1).join('=');

        if (!json && cookie.charAt(0) === '"') {
          cookie = cookie.slice(1, -1);
        }

        try {
          var name = decode(parts[0]);
          cookie = (converter.read || converter)(cookie, name) || decode(cookie);

          if (json) {
            try {
              cookie = JSON.parse(cookie);
            } catch (e) {}
          }

          jar[name] = cookie;

          if (key === name) {
            break;
          }
        } catch (e) {}
      }

      return key ? jar[key] : jar;
    }

    api.set = set;

    api.get = function (key) {
      return get(key, false
      /* read as raw */
      );
    };

    api.getJSON = function (key) {
      return get(key, true
      /* read as json */
      );
    };

    api.remove = function (key, attributes) {
      set(key, '', extend(attributes, {
        expires: -1
      }));
    };

    api.defaults = {};
    api.withConverter = init;
    return api;
  }

  return init(function () {});
});
"use strict";

var previously_viewed_urls = Cookies.getJSON('viewed_urls');
var viewed_urls = [];
var current_url = window.location.pathname;

if ('undefined' !== typeof previously_viewed_urls) {
  viewed_urls = previously_viewed_urls;
}

if (viewed_urls.indexOf(current_url) == -1) {
  viewed_urls.push(window.location.pathname);
}

if ('undefined' !== typeof wp_user_viewed_items_settings) {
  if ('undefined' !== typeof wp_user_viewed_items_settings.domain) {
    var cookie_args = {
      secure: true,
      domain: wp_user_viewed_items_settings.domain
    };

    if ('undefined' !== typeof wp_user_viewed_items_settings.cookie_expires) {
      cookie_args.expires = wp_user_viewed_items_settings.cookie_expires;
    }

    Cookies.set('viewed_urls', viewed_urls, cookie_args);
  }

  if ('undefined' !== typeof wp_user_viewed_items_settings.items_read_number) {
    var items_read_number = wp_user_viewed_items_settings.items_read_number;
  }

  if ('undefined' !== typeof wp_user_viewed_items_settings.action_to_perform) {
    var action_to_perform = wp_user_viewed_items_settings.action_to_perform;
  }

  if (items_read_number < viewed_urls.length && 'popup' === action_to_perform) {
    console.log('load the popup');
    jQuery(document).on('pumInit', '#popmake-300090', function () {
      // we would have to save this popup id as a plugin setting
      PUM.open(300090); // we would have to save this popup id as a plugin setting
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlbmRvci9qcy5jb29raWUuanMiLCJzcmMvdmlzaXRlZC5qcyJdLCJuYW1lcyI6WyJmYWN0b3J5IiwicmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyIiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIk9sZENvb2tpZXMiLCJ3aW5kb3ciLCJDb29raWVzIiwiYXBpIiwibm9Db25mbGljdCIsImV4dGVuZCIsImkiLCJyZXN1bHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJhdHRyaWJ1dGVzIiwia2V5IiwiZGVjb2RlIiwicyIsInJlcGxhY2UiLCJkZWNvZGVVUklDb21wb25lbnQiLCJpbml0IiwiY29udmVydGVyIiwic2V0IiwidmFsdWUiLCJkb2N1bWVudCIsInBhdGgiLCJkZWZhdWx0cyIsImV4cGlyZXMiLCJEYXRlIiwidG9VVENTdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwidGVzdCIsImUiLCJ3cml0ZSIsImVuY29kZVVSSUNvbXBvbmVudCIsIlN0cmluZyIsImVzY2FwZSIsInN0cmluZ2lmaWVkQXR0cmlidXRlcyIsImF0dHJpYnV0ZU5hbWUiLCJzcGxpdCIsImNvb2tpZSIsImdldCIsImpzb24iLCJqYXIiLCJjb29raWVzIiwicGFydHMiLCJzbGljZSIsImpvaW4iLCJjaGFyQXQiLCJuYW1lIiwicmVhZCIsInBhcnNlIiwiZ2V0SlNPTiIsInJlbW92ZSIsIndpdGhDb252ZXJ0ZXIiLCJwcmV2aW91c2x5X3ZpZXdlZF91cmxzIiwidmlld2VkX3VybHMiLCJjdXJyZW50X3VybCIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJpbmRleE9mIiwicHVzaCIsIndwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzIiwiZG9tYWluIiwiY29va2llX2FyZ3MiLCJzZWN1cmUiLCJjb29raWVfZXhwaXJlcyIsIml0ZW1zX3JlYWRfbnVtYmVyIiwiYWN0aW9uX3RvX3BlcmZvcm0iLCJjb25zb2xlIiwibG9nIiwialF1ZXJ5Iiwib24iLCJQVU0iLCJvcGVu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bUJpRCxFQUFuQixDQUF1QixTQUF2QixFQUFrQyxpQkFBbEMsRUFBcUQsWUFBWTtBQUFFO0FBQy9EQyxNQUFBQSxHQUFHLENBQUNDLElBQUosQ0FBVSxNQUFWLEVBRDZELENBQ3pDO0FBQ3ZCLEtBRkQ7QUFHQTtBQUNEIiwiZmlsZSI6IndwLXVzZXItdmlld2VkLWl0ZW1zLWZyb250LWVuZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogSmF2YVNjcmlwdCBDb29raWUgdjIuMi4xXG4gKiBodHRwczovL2dpdGh1Yi5jb20vanMtY29va2llL2pzLWNvb2tpZVxuICpcbiAqIENvcHlyaWdodCAyMDA2LCAyMDE1IEtsYXVzIEhhcnRsICYgRmFnbmVyIEJyYWNrXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqL1xuOyhmdW5jdGlvbiAoZmFjdG9yeSkge1xuXHR2YXIgcmVnaXN0ZXJlZEluTW9kdWxlTG9hZGVyO1xuXHRpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG5cdFx0ZGVmaW5lKGZhY3RvcnkpO1xuXHRcdHJlZ2lzdGVyZWRJbk1vZHVsZUxvYWRlciA9IHRydWU7XG5cdH1cblx0aWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRcdHJlZ2lzdGVyZWRJbk1vZHVsZUxvYWRlciA9IHRydWU7XG5cdH1cblx0aWYgKCFyZWdpc3RlcmVkSW5Nb2R1bGVMb2FkZXIpIHtcblx0XHR2YXIgT2xkQ29va2llcyA9IHdpbmRvdy5Db29raWVzO1xuXHRcdHZhciBhcGkgPSB3aW5kb3cuQ29va2llcyA9IGZhY3RvcnkoKTtcblx0XHRhcGkubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHdpbmRvdy5Db29raWVzID0gT2xkQ29va2llcztcblx0XHRcdHJldHVybiBhcGk7XG5cdFx0fTtcblx0fVxufShmdW5jdGlvbiAoKSB7XG5cdGZ1bmN0aW9uIGV4dGVuZCAoKSB7XG5cdFx0dmFyIGkgPSAwO1xuXHRcdHZhciByZXN1bHQgPSB7fTtcblx0XHRmb3IgKDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGF0dHJpYnV0ZXMgPSBhcmd1bWVudHNbIGkgXTtcblx0XHRcdGZvciAodmFyIGtleSBpbiBhdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdHJlc3VsdFtrZXldID0gYXR0cmlidXRlc1trZXldO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVjb2RlIChzKSB7XG5cdFx0cmV0dXJuIHMucmVwbGFjZSgvKCVbMC05QS1aXXsyfSkrL2csIGRlY29kZVVSSUNvbXBvbmVudCk7XG5cdH1cblxuXHRmdW5jdGlvbiBpbml0IChjb252ZXJ0ZXIpIHtcblx0XHRmdW5jdGlvbiBhcGkoKSB7fVxuXG5cdFx0ZnVuY3Rpb24gc2V0IChrZXksIHZhbHVlLCBhdHRyaWJ1dGVzKSB7XG5cdFx0XHRpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGF0dHJpYnV0ZXMgPSBleHRlbmQoe1xuXHRcdFx0XHRwYXRoOiAnLydcblx0XHRcdH0sIGFwaS5kZWZhdWx0cywgYXR0cmlidXRlcyk7XG5cblx0XHRcdGlmICh0eXBlb2YgYXR0cmlidXRlcy5leHBpcmVzID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRhdHRyaWJ1dGVzLmV4cGlyZXMgPSBuZXcgRGF0ZShuZXcgRGF0ZSgpICogMSArIGF0dHJpYnV0ZXMuZXhwaXJlcyAqIDg2NGUrNSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFdlJ3JlIHVzaW5nIFwiZXhwaXJlc1wiIGJlY2F1c2UgXCJtYXgtYWdlXCIgaXMgbm90IHN1cHBvcnRlZCBieSBJRVxuXHRcdFx0YXR0cmlidXRlcy5leHBpcmVzID0gYXR0cmlidXRlcy5leHBpcmVzID8gYXR0cmlidXRlcy5leHBpcmVzLnRvVVRDU3RyaW5nKCkgOiAnJztcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcblx0XHRcdFx0aWYgKC9eW1xce1xcW10vLnRlc3QocmVzdWx0KSkge1xuXHRcdFx0XHRcdHZhbHVlID0gcmVzdWx0O1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlKSB7fVxuXG5cdFx0XHR2YWx1ZSA9IGNvbnZlcnRlci53cml0ZSA/XG5cdFx0XHRcdGNvbnZlcnRlci53cml0ZSh2YWx1ZSwga2V5KSA6XG5cdFx0XHRcdGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcodmFsdWUpKVxuXHRcdFx0XHRcdC5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDNBfDNDfDNFfDNEfDJGfDNGfDQwfDVCfDVEfDVFfDYwfDdCfDdEfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpO1xuXG5cdFx0XHRrZXkgPSBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGtleSkpXG5cdFx0XHRcdC5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDVFfDYwfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpXG5cdFx0XHRcdC5yZXBsYWNlKC9bXFwoXFwpXS9nLCBlc2NhcGUpO1xuXG5cdFx0XHR2YXIgc3RyaW5naWZpZWRBdHRyaWJ1dGVzID0gJyc7XG5cdFx0XHRmb3IgKHZhciBhdHRyaWJ1dGVOYW1lIGluIGF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0aWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0c3RyaW5naWZpZWRBdHRyaWJ1dGVzICs9ICc7ICcgKyBhdHRyaWJ1dGVOYW1lO1xuXHRcdFx0XHRpZiAoYXR0cmlidXRlc1thdHRyaWJ1dGVOYW1lXSA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ29uc2lkZXJzIFJGQyA2MjY1IHNlY3Rpb24gNS4yOlxuXHRcdFx0XHQvLyAuLi5cblx0XHRcdFx0Ly8gMy4gIElmIHRoZSByZW1haW5pbmcgdW5wYXJzZWQtYXR0cmlidXRlcyBjb250YWlucyBhICV4M0IgKFwiO1wiKVxuXHRcdFx0XHQvLyAgICAgY2hhcmFjdGVyOlxuXHRcdFx0XHQvLyBDb25zdW1lIHRoZSBjaGFyYWN0ZXJzIG9mIHRoZSB1bnBhcnNlZC1hdHRyaWJ1dGVzIHVwIHRvLFxuXHRcdFx0XHQvLyBub3QgaW5jbHVkaW5nLCB0aGUgZmlyc3QgJXgzQiAoXCI7XCIpIGNoYXJhY3Rlci5cblx0XHRcdFx0Ly8gLi4uXG5cdFx0XHRcdHN0cmluZ2lmaWVkQXR0cmlidXRlcyArPSAnPScgKyBhdHRyaWJ1dGVzW2F0dHJpYnV0ZU5hbWVdLnNwbGl0KCc7JylbMF07XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAoZG9jdW1lbnQuY29va2llID0ga2V5ICsgJz0nICsgdmFsdWUgKyBzdHJpbmdpZmllZEF0dHJpYnV0ZXMpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGdldCAoa2V5LCBqc29uKSB7XG5cdFx0XHRpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHZhciBqYXIgPSB7fTtcblx0XHRcdC8vIFRvIHByZXZlbnQgdGhlIGZvciBsb29wIGluIHRoZSBmaXJzdCBwbGFjZSBhc3NpZ24gYW4gZW1wdHkgYXJyYXlcblx0XHRcdC8vIGluIGNhc2UgdGhlcmUgYXJlIG5vIGNvb2tpZXMgYXQgYWxsLlxuXHRcdFx0dmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUgPyBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsgJykgOiBbXTtcblx0XHRcdHZhciBpID0gMDtcblxuXHRcdFx0Zm9yICg7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBwYXJ0cyA9IGNvb2tpZXNbaV0uc3BsaXQoJz0nKTtcblx0XHRcdFx0dmFyIGNvb2tpZSA9IHBhcnRzLnNsaWNlKDEpLmpvaW4oJz0nKTtcblxuXHRcdFx0XHRpZiAoIWpzb24gJiYgY29va2llLmNoYXJBdCgwKSA9PT0gJ1wiJykge1xuXHRcdFx0XHRcdGNvb2tpZSA9IGNvb2tpZS5zbGljZSgxLCAtMSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdHZhciBuYW1lID0gZGVjb2RlKHBhcnRzWzBdKTtcblx0XHRcdFx0XHRjb29raWUgPSAoY29udmVydGVyLnJlYWQgfHwgY29udmVydGVyKShjb29raWUsIG5hbWUpIHx8XG5cdFx0XHRcdFx0XHRkZWNvZGUoY29va2llKTtcblxuXHRcdFx0XHRcdGlmIChqc29uKSB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb29raWUgPSBKU09OLnBhcnNlKGNvb2tpZSk7XG5cdFx0XHRcdFx0XHR9IGNhdGNoIChlKSB7fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGphcltuYW1lXSA9IGNvb2tpZTtcblxuXHRcdFx0XHRcdGlmIChrZXkgPT09IG5hbWUpIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGtleSA/IGphcltrZXldIDogamFyO1xuXHRcdH1cblxuXHRcdGFwaS5zZXQgPSBzZXQ7XG5cdFx0YXBpLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcblx0XHRcdHJldHVybiBnZXQoa2V5LCBmYWxzZSAvKiByZWFkIGFzIHJhdyAqLyk7XG5cdFx0fTtcblx0XHRhcGkuZ2V0SlNPTiA9IGZ1bmN0aW9uIChrZXkpIHtcblx0XHRcdHJldHVybiBnZXQoa2V5LCB0cnVlIC8qIHJlYWQgYXMganNvbiAqLyk7XG5cdFx0fTtcblx0XHRhcGkucmVtb3ZlID0gZnVuY3Rpb24gKGtleSwgYXR0cmlidXRlcykge1xuXHRcdFx0c2V0KGtleSwgJycsIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG5cdFx0XHRcdGV4cGlyZXM6IC0xXG5cdFx0XHR9KSk7XG5cdFx0fTtcblxuXHRcdGFwaS5kZWZhdWx0cyA9IHt9O1xuXG5cdFx0YXBpLndpdGhDb252ZXJ0ZXIgPSBpbml0O1xuXG5cdFx0cmV0dXJuIGFwaTtcblx0fVxuXG5cdHJldHVybiBpbml0KGZ1bmN0aW9uICgpIHt9KTtcbn0pKTtcbiIsInZhciBwcmV2aW91c2x5X3ZpZXdlZF91cmxzID0gQ29va2llcy5nZXRKU09OKCAndmlld2VkX3VybHMnICk7XG52YXIgdmlld2VkX3VybHMgPSBbXTtcbnZhciBjdXJyZW50X3VybCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTtcbmlmICggJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiBwcmV2aW91c2x5X3ZpZXdlZF91cmxzICkge1xuXHR2aWV3ZWRfdXJscyA9IHByZXZpb3VzbHlfdmlld2VkX3VybHM7XG59XG5pZiAoIHZpZXdlZF91cmxzLmluZGV4T2YoIGN1cnJlbnRfdXJsICkgPT0gLTEgKSB7XG5cdHZpZXdlZF91cmxzLnB1c2goIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSApO1xufVxuaWYgKCAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdwX3VzZXJfdmlld2VkX2l0ZW1zX3NldHRpbmdzICkge1xuXHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuZG9tYWluICkge1xuXHRcdHZhciBjb29raWVfYXJncyA9IHtcblx0XHRcdHNlY3VyZTogdHJ1ZSxcblx0XHRcdGRvbWFpbjogd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuZG9tYWluXG5cdFx0fTtcblx0XHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuY29va2llX2V4cGlyZXMgKSB7XG5cdFx0XHRjb29raWVfYXJncy5leHBpcmVzID0gd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuY29va2llX2V4cGlyZXM7XG5cdFx0fVxuXHRcdENvb2tpZXMuc2V0KFxuXHRcdFx0J3ZpZXdlZF91cmxzJyxcblx0XHRcdHZpZXdlZF91cmxzLFxuXHRcdFx0Y29va2llX2FyZ3Ncblx0XHQpO1xuXHR9XG5cdGlmICggJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncy5pdGVtc19yZWFkX251bWJlciApIHtcblx0XHR2YXIgaXRlbXNfcmVhZF9udW1iZXIgPSB3cF91c2VyX3ZpZXdlZF9pdGVtc19zZXR0aW5ncy5pdGVtc19yZWFkX251bWJlcjtcblx0fVxuXHRpZiAoICd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuYWN0aW9uX3RvX3BlcmZvcm0gKSB7XG5cdFx0dmFyIGFjdGlvbl90b19wZXJmb3JtID0gd3BfdXNlcl92aWV3ZWRfaXRlbXNfc2V0dGluZ3MuYWN0aW9uX3RvX3BlcmZvcm07XG5cdH1cblx0aWYgKCBpdGVtc19yZWFkX251bWJlciA8IHZpZXdlZF91cmxzLmxlbmd0aCAmJiAncG9wdXAnID09PSBhY3Rpb25fdG9fcGVyZm9ybSApIHtcblx0XHRjb25zb2xlLmxvZyggJ2xvYWQgdGhlIHBvcHVwJyApO1xuXHRcdGpRdWVyeSggZG9jdW1lbnQgKS5vbiggJ3B1bUluaXQnLCAnI3BvcG1ha2UtMzAwMDkwJywgZnVuY3Rpb24gKCkgeyAvLyB3ZSB3b3VsZCBoYXZlIHRvIHNhdmUgdGhpcyBwb3B1cCBpZCBhcyBhIHBsdWdpbiBzZXR0aW5nXG5cdFx0ICAgIFBVTS5vcGVuKCAzMDAwOTAgKTsgLy8gd2Ugd291bGQgaGF2ZSB0byBzYXZlIHRoaXMgcG9wdXAgaWQgYXMgYSBwbHVnaW4gc2V0dGluZ1xuXHRcdH0pO1xuXHR9XG59Il19
